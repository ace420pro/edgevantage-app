@tailwind base;
@tailwind components;
@tailwind utilities;

/* Custom base styles with enhanced accessibility - WCAG 2.1 AA compliant */
@layer base {
  /* Root variables for consistent theming */
  :root {
    --focus-ring-color: #3b82f6;
    --focus-ring-width: 2px;
    --focus-ring-offset: 2px;
    --min-touch-target: 44px;
    --text-contrast-ratio: 4.5;
  }

  /* Smooth scrolling with reduced motion support */
  html {
    scroll-behavior: smooth;
    font-size: 16px; /* Ensure 16px base for accessibility */
  }
  
  @media (prefers-reduced-motion: reduce) {
    html {
      scroll-behavior: auto;
    }
    
    *, *::before, *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }
  
  body {
    margin: 0;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
      'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
      sans-serif;
    font-feature-settings: 'kern', 'liga', 'calt', 'ss01', 'tnum';
    font-variant-numeric: tabular-nums;
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-optical-sizing: auto;
    line-height: 1.6; /* WCAG 2.1 AA recommended minimum */
    font-size: 1rem; /* 16px base size */
    font-weight: 400; /* Regular weight for body text */
    color: #111827; /* High contrast text */
    background-color: #ffffff; /* High contrast background */
  }

  code {
    font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',
      monospace;
  }

  /* Enhanced focus styles for WCAG 2.1 AA compliance */
  *:focus {
    outline: var(--focus-ring-width) solid var(--focus-ring-color);
    outline-offset: var(--focus-ring-offset);
    /* Ensure focus is always visible */
    position: relative;
    z-index: 1;
  }

  /* Focus-visible for modern browsers - improved visibility */
  *:focus-visible {
    outline: var(--focus-ring-width) solid var(--focus-ring-color);
    outline-offset: var(--focus-ring-offset);
    box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
  }

  /* Keep focus outline for all interaction methods for maximum accessibility */
  *:focus:not(:focus-visible) {
    outline: 1px solid var(--focus-ring-color);
    outline-offset: 1px;
  }

  /* High contrast mode support */
  @media (prefers-contrast: high) {
    .high-contrast {
      --tw-text-opacity: 1;
      --tw-bg-opacity: 1;
    }
    
    .high-contrast button {
      border: 2px solid currentColor;
    }
    
    .high-contrast input, 
    .high-contrast select, 
    .high-contrast textarea {
      border: 2px solid currentColor;
    }
  }

  /* Screen reader only content */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  /* Show screen reader content when focused */
  .sr-only:focus,
  .sr-only:active {
    position: static;
    width: auto;
    height: auto;
    padding: 0.5rem 1rem;
    margin: 0;
    overflow: visible;
    clip: auto;
    white-space: normal;
    background-color: theme('colors.blue.600');
    color: white;
    border-radius: 0.375rem;
    text-decoration: none;
    z-index: 100000;
  }

  /* Skip links */
  .skip-link {
    position: absolute;
    top: -40px;
    left: 6px;
    background: theme('colors.blue.600');
    color: white;
    padding: 8px;
    border-radius: 4px;
    text-decoration: none;
    z-index: 100000;
    transition: top 0.3s;
  }

  .skip-link:focus {
    top: 6px;
  }

  /* Improved heading hierarchy with professional typography */
  h1 { 
    font-family: 'Poppins', 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    font-size: 2.25rem; 
    font-weight: 800; 
    line-height: 1.2; 
    margin-bottom: 1rem;
    letter-spacing: -0.025em;
  }
  h2 { 
    font-family: 'Poppins', 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    font-size: 1.875rem; 
    font-weight: 700; 
    line-height: 1.3; 
    margin-bottom: 0.875rem;
    letter-spacing: -0.025em;
  }
  h3 { 
    font-family: 'Poppins', 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    font-size: 1.5rem; 
    font-weight: 600; 
    line-height: 1.4; 
    margin-bottom: 0.75rem;
    letter-spacing: -0.015em;
  }
  h4 { 
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    font-size: 1.25rem; 
    font-weight: 600; 
    line-height: 1.5; 
    margin-bottom: 0.625rem;
  }
  h5 { 
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    font-size: 1.125rem; 
    font-weight: 500; 
    line-height: 1.5; 
    margin-bottom: 0.5rem;
  }
  h6 { 
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    font-size: 1rem; 
    font-weight: 500; 
    line-height: 1.5; 
    margin-bottom: 0.5rem;
  }

  /* Ensure sufficient line height for readability */
  p, li, td, th {
    line-height: 1.6;
  }

  /* Link accessibility */
  a {
    text-underline-offset: 0.125rem;
    transition: all 0.2s ease;
  }

  a:hover {
    text-decoration-thickness: 2px;
  }

  a:focus {
    text-decoration: underline;
    text-decoration-thickness: 2px;
  }
}

/* Custom component styles */
@layer components {
  /* Accessibility-first button variants - WCAG 2.1 AA compliant */
  .btn {
    @apply inline-flex items-center justify-center px-6 py-3 font-semibold text-base rounded-xl transition-all duration-200 focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed;
    min-height: var(--min-touch-target); /* Ensure 44px minimum touch target */
    min-width: var(--min-touch-target);
    position: relative;
  }

  .btn:focus {
    outline: var(--focus-ring-width) solid var(--focus-ring-color);
    outline-offset: var(--focus-ring-offset);
    z-index: 10;
  }

  .btn-primary {
    @apply btn bg-gradient-to-r from-blue-600 to-emerald-600 text-white hover:shadow-lg focus:ring-blue-500;
    /* Ensure 4.5:1 contrast ratio */
    color: #ffffff;
    background: linear-gradient(to right, #2563eb, #059669);
  }

  .btn-primary:hover:not(:disabled) {
    transform: translateY(-1px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
  }

  .btn-secondary {
    @apply btn bg-white text-gray-900 border-2 border-gray-400 hover:bg-gray-50 hover:border-gray-500 focus:ring-gray-500;
    /* Enhanced border and contrast for accessibility */
  }

  .btn-ghost {
    @apply btn bg-transparent text-gray-900 hover:bg-gray-100 focus:ring-gray-500;
    /* Improved text contrast */
  }

  /* High contrast mode button enhancements */
  @media (prefers-contrast: high) {
    .btn {
      border: 2px solid currentColor;
      font-weight: 700;
    }
    
    .btn-primary {
      background: #000000;
      color: #ffffff;
      border-color: #ffffff;
    }
    
    .btn-secondary,
    .btn-ghost {
      background: #ffffff;
      color: #000000;
      border-color: #000000;
    }
  }

  /* Card component */
  .card {
    @apply bg-white rounded-2xl border border-gray-200 shadow-lg hover:shadow-xl transition-shadow duration-200;
  }

  .card-padding {
    @apply p-6 sm:p-8;
  }

  /* Accessibility-enhanced form components */
  .form-input {
    @apply w-full px-4 py-3 border-2 border-gray-400 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-base transition-all duration-200 placeholder-gray-500;
    min-height: var(--min-touch-target); /* 44px minimum touch target */
    font-size: 1rem; /* Prevent zoom on iOS */
    background-color: #ffffff;
    color: #111827; /* High contrast text */
  }

  .form-input:focus {
    outline: var(--focus-ring-width) solid var(--focus-ring-color);
    outline-offset: 1px;
    border-color: var(--focus-ring-color);
  }

  .form-input-error {
    @apply form-input border-red-600 focus:ring-red-500 focus:border-red-500;
    background-color: #fef2f2; /* Light red background for error state */
  }

  .form-input:disabled {
    @apply bg-gray-100 text-gray-500 cursor-not-allowed;
    opacity: 0.6;
  }

  .form-label {
    @apply block text-sm font-semibold text-gray-900 mb-2;
    color: #111827; /* High contrast for labels */
  }

  .form-label[aria-required="true"]::after {
    content: " *";
    color: #dc2626; /* Red for required indicator */
  }

  .form-error {
    @apply flex items-center mt-2 text-red-700 text-sm font-medium;
    /* Enhanced error text contrast */
  }

  .form-help-text {
    @apply text-sm text-gray-700 mt-1;
    /* Improved help text contrast */
  }

  /* Select dropdown accessibility */
  .form-select {
    @apply form-input appearance-none;
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
    background-position: right 0.75rem center;
    background-repeat: no-repeat;
    background-size: 1.5em 1.5em;
    padding-right: 2.5rem;
  }

  /* Checkbox and radio accessibility */
  .form-checkbox,
  .form-radio {
    width: 1.25rem;
    height: 1.25rem;
    margin-right: 0.75rem;
    border: 2px solid #6b7280;
    background-color: #ffffff;
  }

  .form-checkbox:checked,
  .form-radio:checked {
    background-color: var(--focus-ring-color);
    border-color: var(--focus-ring-color);
  }

  .form-checkbox:focus,
  .form-radio:focus {
    outline: var(--focus-ring-width) solid var(--focus-ring-color);
    outline-offset: 2px;
  }

  /* High contrast form enhancements */
  @media (prefers-contrast: high) {
    .form-input,
    .form-select {
      border: 3px solid #000000;
      background-color: #ffffff;
      color: #000000;
    }
    
    .form-input:focus,
    .form-select:focus {
      outline: 3px solid #000000;
      outline-offset: 2px;
    }
    
    .form-label {
      color: #000000;
      font-weight: 700;
    }
    
    .form-error {
      color: #000000;
      font-weight: 700;
      background-color: #ffffff;
      padding: 0.25rem 0.5rem;
      border: 2px solid #000000;
    }
  }

  /* Gradient backgrounds */
  .gradient-primary {
    @apply bg-gradient-to-r from-blue-600 to-emerald-600;
  }

  .gradient-secondary {
    @apply bg-gradient-to-r from-emerald-600 to-blue-600;
  }

  .gradient-accent {
    @apply bg-gradient-to-r from-purple-600 to-blue-600;
  }

  /* Text gradients */
  .text-gradient-primary {
    @apply text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-emerald-600;
  }

  /* Status indicators */
  .status-online {
    @apply w-2 h-2 bg-green-500 rounded-full animate-pulse;
  }

  /* Layout utilities */
  .container-main {
    @apply max-w-7xl mx-auto px-4 sm:px-6;
  }

  .container-narrow {
    @apply max-w-3xl mx-auto px-4 sm:px-6;
  }

  .section-padding {
    @apply py-12 sm:py-16;
  }
}

/* Custom utility classes with accessibility enhancements */
@layer utilities {
  /* Animation utilities with reduced motion support */
  .animate-fade-in {
    animation: fadeIn 0.5s ease-in-out;
  }

  .animate-zoom-in {
    animation: zoomIn 0.3s ease-out;
  }

  .animate-slide-up {
    animation: slideUp 0.3s ease-out;
  }

  .animate-bounce-subtle {
    animation: bounceSubtle 2s infinite;
  }

  .animate-pulse-slow {
    animation: pulseText 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @keyframes zoomIn {
    from { opacity: 0; transform: scale(0.9); }
    to { opacity: 1; transform: scale(1); }
  }

  @keyframes slideUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @keyframes bounceSubtle {
    0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
    40% { transform: translateY(-3px); }
    60% { transform: translateY(-1px); }
  }

  @keyframes pulseText {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
  }

  /* Loading states with accessibility */
  .loading-shimmer {
    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
    background-size: 200% 100%;
    animation: loading 1.5s infinite;
  }

  @keyframes loading {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
  }

  /* Focus management utilities */
  .focus-within-ring {
    @apply focus-within:ring-2 focus-within:ring-blue-500 focus-within:ring-offset-2;
  }

  .focus-visible-ring {
    @apply focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2;
  }

  /* Touch target utilities */
  .touch-target {
    min-width: 44px;
    min-height: 44px;
  }

  .touch-target-lg {
    min-width: 48px;
    min-height: 48px;
  }

  /* High contrast utilities */
  .high-contrast-border {
    @apply border-2 border-current;
  }

  .high-contrast-bg {
    @apply bg-white text-black;
  }

  @media (prefers-contrast: high) {
    .high-contrast-auto {
      @apply high-contrast-border;
    }
  }

  /* Typography utility classes for consistency */
  .text-display {
    font-family: 'Poppins', 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    font-weight: 600;
    letter-spacing: -0.025em;
    font-variant-numeric: tabular-nums;
    font-feature-settings: 'tnum';
  }

  .text-display-lg {
    font-family: 'Poppins', 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    font-weight: 700;
    letter-spacing: -0.025em;
    font-variant-numeric: tabular-nums;
    font-feature-settings: 'tnum';
  }

  /* Professional number styling utility */
  .text-numbers,
  .font-numbers {
    font-variant-numeric: tabular-nums;
    font-feature-settings: 'tnum';
  }

  .text-body-sm {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    font-size: 0.875rem;
    line-height: 1.5;
  }

  .text-body-lg {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    font-size: 1.125rem;
    line-height: 1.7;
  }

  /* Text readability utilities */
  .text-readable {
    line-height: 1.6;
    font-size: 1rem;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  }

  .text-readable-lg {
    line-height: 1.7;
    font-size: 1.125rem;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  }

  /* Spacing utilities for accessibility */
  .space-accessible > * + * {
    margin-top: 1.5rem;
  }

  .space-accessible-sm > * + * {
    margin-top: 1rem;
  }

  .space-accessible-lg > * + * {
    margin-top: 2rem;
  }

  /* Status indication utilities */
  .status-success {
    @apply bg-emerald-50 text-emerald-800 border border-emerald-200;
  }

  .status-warning {
    @apply bg-yellow-50 text-yellow-800 border border-yellow-200;
  }

  .status-error {
    @apply bg-red-50 text-red-800 border border-red-200;
  }

  .status-info {
    @apply bg-blue-50 text-blue-800 border border-blue-200;
  }

  /* Interaction state utilities */
  .interactive {
    @apply transition-all duration-200 cursor-pointer;
    @apply hover:shadow-md focus:shadow-lg;
    @apply focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2;
  }

  .interactive-subtle {
    @apply transition-colors duration-200 cursor-pointer;
    @apply hover:bg-gray-50 focus:bg-gray-100;
    @apply focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1;
  }

  /* Reduced motion overrides */
  @media (prefers-reduced-motion: reduce) {
    .reduced-motion .animate-fade-in,
    .reduced-motion .animate-zoom-in,
    .reduced-motion .animate-slide-up,
    .reduced-motion .animate-bounce-subtle,
    .reduced-motion .animate-pulse-slow {
      animation: none;
    }

    .reduced-motion .loading-shimmer {
      animation: none;
      background: #e0e0e0;
    }

    .reduced-motion .transition-all,
    .reduced-motion .transition-colors,
    .reduced-motion .transition-transform,
    .reduced-motion .transition-shadow {
      transition: none;
    }
  }

  /* Print styles */
  @media print {
    .print-hidden {
      display: none !important;
    }

    .print-visible {
      display: block !important;
    }

    .print-page-break {
      page-break-before: always;
    }

    .print-no-break {
      page-break-inside: avoid;
    }
  }
}
